<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Secure Express - Candidate Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 20px;
      line-height: 1.6;
    }
    .section {
      margin-bottom: 30px;
    }
    .timer {
      font-size: 20px;
      font-weight: bold;
      color: red;
    }
    textarea {
      width: 100%;
      height: 150px;
      font-size: 16px;
    }
    input[type="text"], input[type="email"] {
      width: 300px;
      padding: 6px;
      margin-bottom: 10px;
    }
    .disabled {
      opacity: 0.6;
      pointer-events: none;
    }
  </style>
</head>
<body>

  <h1>Secure Express - Candidate Test</h1>
  <div class="section">
    <label>Full Name:</label><br>
    <input type="text" id="name" /><br>
    <label>Email:</label><br>
    <input type="email" id="email" />
  </div>

  <div class="section">
    <span class="timer" id="timer">Time Left: 30:00</span>
  </div>

  <div class="section">
    <h2>üß† Multiple Choice Questions</h2>
    <div>
      <p>1. A client calls in complaining their driver is 10 minutes late. You see the vehicle is stationary 500m from the pickup location. What is the BEST first response?</p>
      <label><input type="radio" name="q1" value="A"> A) ‚ÄúI will contact the driver and call you back.‚Äù</label><br>
      <label><input type="radio" name="q1" value="B"> B) ‚ÄúThe vehicle is nearby; please wait, it should arrive shortly.‚Äù</label><br>
      <label><input type="radio" name="q1" value="C"> C) ‚ÄúI can see the vehicle is close. I‚Äôll update the driver now and confirm with you shortly.‚Äù</label><br>
      <label><input type="radio" name="q1" value="D"> D) ‚ÄúI will escalate this to operations immediately.‚Äù</label>
    </div>
    <!-- Add more questions similarly -->
  </div>

  <div class="section">
    <h2>‚å®Ô∏è Typing Test (2 minutes)</h2>
    <p id="typingInstructions">Type the following 100-word paragraph below:</p>
    <p id="typingText" style="background:#fff;padding:10px;border:1px solid #ccc;">
      Reliable transport services require attention to detail, strong communication, and rapid response during client engagements. Our drivers follow strict protocols, including vehicle checks, uniform compliance, and secure onboarding of passengers. Whether the ride involves a VIP client or an airport transfer, each trip is monitored in real-time with tracking systems and control room oversight. As a fleet controller, your role is to maintain this gold standard at all times, escalate delays swiftly, and document every deviation from standard operating procedures. Professionalism, speed, and accuracy are non-negotiable. Your performance directly affects the safety, trust, and satisfaction of our clients.
    </p>
    <textarea id="typingInput" placeholder="Start typing here..." disabled></textarea><br>
    <button onclick="submitTyping()" id="submitTypingBtn" disabled>Submit Typing Test</button>
    <div id="typingResults"></div>
  </div>

  <div class="section">
    <button onclick="submitAll()">Submit Full Test</button>
  </div>

  <script>
    let totalTime = 1800; // 30 minutes
    let typingDuration = 120; // 2 minutes
    let typingStarted = false;
    let typingStartTime;
    let typingTimer;
    const typingText = document.getElementById("typingText").innerText.trim();

    window.onload = function() {
      startUnifiedTimer();
    };

    function startUnifiedTimer() {
      const timerDisplay = document.getElementById("timer");
      let countdown = setInterval(() => {
        const minutes = Math.floor(totalTime / 60);
        const seconds = totalTime % 60;
        timerDisplay.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;

        if (totalTime === 10) alert("‚è∞ 10 seconds remaining!");
        if (totalTime === 0) {
          clearInterval(countdown);
          disableInputs();
          submitAll();
          alert("Time is up. Your test has been submitted automatically.");
        }
        totalTime--;
      }, 1000);
    }

    function enableTyping() {
      if (document.getElementById("typingInput").disabled) {
        const timeLeft = totalTime;
        if (timeLeft < 120) alert("‚ö†Ô∏è You have less than 2 minutes left. Use your time wisely.");
        document.getElementById("typingInput").disabled = false;
        document.getElementById("submitTypingBtn").disabled = false;
        typingStarted = true;
        typingStartTime = Date.now();
        typingTimer = setTimeout(() => {
          submitTyping();
        }, typingDuration * 1000);
      }
    }

    function submitTyping() {
      clearTimeout(typingTimer);
      const typedText = document.getElementById("typingInput").value.trim();
      const originalWords = typingText.split(/\s+/);
      const typedWords = typedText.split(/\s+/);
      const wordsTyped = typedWords.length;
      let correct = 0;

      for (let i = 0; i < typedWords.length; i++) {
        if (typedWords[i] === originalWords[i]) correct++;
      }

      const timeSpent = (Date.now() - typingStartTime) / 1000 / 60;
      const wpm = Math.round(wordsTyped / timeSpent);
      const accuracy = Math.round((correct / originalWords.length) * 100);

      document.getElementById("typingResults").innerHTML =
        `<strong>Typing Results:</strong><br>
        WPM: ${wpm}<br>
        Accuracy: ${accuracy}%<br>
        Words Typed: ${wordsTyped}<br>
        Completed in: ${timeSpent.toFixed(2)} minutes`;

      document.getElementById("typingInput").disabled = true;
      document.getElementById("submitTypingBtn").disabled = true;
    }

    function disableInputs() {
      const inputs = document.querySelectorAll("input, textarea, button");
      inputs.forEach(el => el.disabled = true);
    }

    function submitAll() {
      const name = document.getElementById("name").value.trim();
      const email = document.getElementById("email").value.trim();
      let answers = `Name: ${name}\nEmail: ${email}\n\n`;

      for (let i = 1; i <= 1; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        answers += `Q${i}: ${selected ? selected.value : 'Not answered'}\n`;
      }

      const results = document.getElementById("typingResults").innerText;
      answers += `\nTyping Test:\n${results}`;

      console.log(answers);
      alert("‚úÖ Test submitted.\nCheck developer console (F12 > Console) to view the results.");
    }

    // Enable typing area on focus
    document.getElementById("typingInput").addEventListener("focus", enableTyping);
  </script>
</body>
</html>
