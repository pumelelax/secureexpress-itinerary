<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSS Practical Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fff;
      color: #333;
      padding: 20px;
    }
    h1 {
      color: red;
    }
    .hidden {
      display: none;
    }
    textarea {
      width: 100%;
      height: 100px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
    }
    button {
      padding: 10px 20px;
      background-color: red;
      color: white;
      border: none;
      cursor: pointer;
    }
    .result {
      margin-top: 20px;
      border-top: 1px solid #ccc;
      padding-top: 20px;
    }
  </style>
</head>
<body>

  <h1>CSS Practical Test</h1>

  <div id="start">
    <label>Enter your name:</label><br>
    <input type="text" id="candidateName"><br><br>
    <button onclick="startTypingTest()">Start Test</button>
  </div>

  <div id="typingTest" class="hidden">
    <h2>Typing Test (2 minutes)</h2>
    <p id="paragraph">
      Thank you for contacting our customer service team. We appreciate your patience and will do our best to resolve your issue promptly and professionally.
    </p>
    <textarea id="typedText" placeholder="Start typing here..."></textarea><br>
    <p>Time left: <span id="timer">120</span> seconds</p>
  </div>

  <div id="excelTest" class="hidden">
    <h2>Excel Formula Questions</h2>
    <form id="excelForm">
      <label>1. What formula adds values in cells A1 to A5?</label><br>
      <input type="text" name="q1"><br><br>

      <label>2. What formula returns the number of cells that are not empty in a range?</label><br>
      <input type="text" name="q2"><br><br>

      <label>3. What formula checks if a condition is true or false?</label><br>
      <input type="text" name="q3"><br><br>

      <label>4. What formula looks up a value in a table?</label><br>
      <input type="text" name="q4"><br><br>

      <label>5. What formula counts cells that meet a condition?</label><br>
      <input type="text" name="q5"><br><br>

      <button type="button" onclick="showResults()">Submit Answers</button>
    </form>
  </div>

  <div id="results" class="hidden result">
    <h2>Results</h2>
    <p><strong>Name:</strong> <span id="resultName"></span></p>
    <p><strong>Typing Speed:</strong> <span id="wpm"></span> WPM</p>
    <p><strong>Excel Score:</strong> <span id="excelScore"></span>/5</p>
  </div>

  <script>
    let timer;
    let timeLeft = 120;
    let startTime;
    const paragraphText = document.getElementById("paragraph").innerText;

    function startTypingTest() {
      const name = document.getElementById("candidateName").value.trim();
      if (!name) return alert("Please enter your name.");

      document.getElementById("start").classList.add("hidden");
      document.getElementById("typingTest").classList.remove("hidden");
      startTime = new Date();

      timer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timer);
          document.getElementById("typingTest").classList.add("hidden");
          document.getElementById("excelTest").classList.remove("hidden");
        }
      }, 1000);
    }

    function showResults() {
      const name = document.getElementById("candidateName").value;
      const typed = document.getElementById("typedText").value;
      const wordsTyped = typed.trim().split(/\s+/).length;
      const minutes = 2;
      const wpm = Math.round(wordsTyped / minutes);

      const answers = {
        q1: "SUM(A1:A5)",
        q2: "COUNTA",
        q3: "IF",
        q4: "VLOOKUP",
        q5: "COUNTIF"
      };

      let score = 0;
      const form = document.getElementById("excelForm");
      for (let key in answers) {
        const userAnswer = form[key].value.trim().toUpperCase();
        if (userAnswer === answers[key].toUpperCase()) score++;
      }

      document.getElementById("excelTest").classList.add("hidden");
      document.getElementById("results").classList.remove("hidden");
      document.getElementById("resultName").innerText = name;
      document.getElementById("wpm").innerText = wpm;
      document.getElementById("excelScore").innerText = score;

      // Create downloadable text file
      const resultText = `CSS Practical Test Results\n\nCandidate Name: ${name}\nTyping Speed: ${wpm} WPM\nExcel Quiz Score: ${score}/5\n`;
      const blob = new Blob([resultText], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${name.replace(/\s+/g, '_')}_CSS_Test_Results.txt`;
      link.textContent = "Download Your Results";
      link.style.display = "block";
      link.style.marginTop = "10px";
      document.getElementById("results").appendChild(link);
    }
  </script>

</body>
</html>
